<% content_for(:title) { "Cancel Booking" } %>

<div class="bg-white shadow rounded-lg overflow-hidden">
  <% if @booking.status == "cancelled" %>
    <div class="px-6 py-8 text-center">
      <div class="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-gray-100">
        <svg class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </div>
      <h1 class="mt-4 text-2xl font-bold text-gray-900">Booking Already Cancelled</h1>
      <p class="mt-2 text-sm text-gray-600">This booking has already been cancelled.</p>
    </div>
  <% else %>
    <% link = @booking.schedule_link %>
    <% timezone = ActiveSupport::TimeZone[@booking.invitee_timezone] %>

    <div class="px-6 py-8 text-center">
      <h1 class="text-2xl font-bold text-gray-900">Cancel Booking</h1>
      <p class="mt-2 text-sm text-gray-600">Are you sure you want to cancel this booking?</p>
    </div>

    <div class="border-t border-gray-200 px-6 py-5">
      <dl class="space-y-4">
        <div>
          <dt class="text-sm font-medium text-gray-500">Meeting</dt>
          <dd class="mt-1 text-sm text-gray-900"><%= link.meeting_name %></dd>
        </div>

        <div>
          <dt class="text-sm font-medium text-gray-500">Date & Time</dt>
          <dd class="mt-1 text-sm text-gray-900">
            <%= @booking.start_time.in_time_zone(timezone).strftime("%A, %B %-d, %Y") %>
            <br>
            <%= @booking.start_time.in_time_zone(timezone).strftime("%-I:%M %p") %> &ndash;
            <%= @booking.end_time.in_time_zone(timezone).strftime("%-I:%M %p") %>
            (<%= timezone.name %>)
          </dd>
        </div>
      </dl>
    </div>

    <div class="border-t border-gray-200 px-6 py-4">
      <%= form_with url: booking_cancellation_path(id: @booking.id, token: params[:token]), method: :post do %>
        <button type="submit"
                class="w-full rounded-md bg-red-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600">
          Cancel this booking
        </button>
      <% end %>
    </div>
  <% end %>
</div>
