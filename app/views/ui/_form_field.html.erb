<%# locals: (form:, field:, label: nil, type: :text, hint: nil, required: false, options: nil, placeholder: nil, readonly: false, value: nil) %>
<%
  label_text = label || field.to_s.humanize
  obj = form.object.is_a?(ActiveModel::Model) ? form.object : nil
  has_error = obj&.errors&.include?(field)
  input_css = "block w-full rounded-lg border-0 py-2 px-3 text-gray-900 shadow-sm ring-1 ring-inset focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"
  input_css += has_error ? " ring-red-300 focus:ring-red-500" : " ring-gray-300 focus:ring-gray-900"
  input_css += " bg-gray-50" if readonly
%>

<div class="mb-4">
  <%= form.label field, label_text, class: "block text-sm font-medium text-gray-700 mb-1" %>

  <% case type.to_sym %>
  <% when :select %>
    <%= form.select field, options, { prompt: required ? "Select..." : nil }, class: input_css, required: required %>
  <% when :textarea %>
    <%= form.text_area field, class: input_css, required: required, placeholder: placeholder, rows: 4 %>
  <% when :password %>
    <%= form.password_field field, class: input_css, required: required, placeholder: placeholder %>
  <% when :email %>
    <%= form.email_field field, class: input_css, required: required, placeholder: placeholder, readonly: readonly, **({ value: value } if value) %>
  <% else %>
    <%= form.text_field field, class: input_css, required: required, placeholder: placeholder, readonly: readonly, **({ value: value } if value) %>
  <% end %>

  <% if hint %>
    <p class="mt-1 text-sm text-gray-500"><%= hint %></p>
  <% end %>

  <% if has_error %>
    <% obj.errors.full_messages_for(field).each do |message| %>
      <p class="mt-1 text-sm text-red-600"><%= message %></p>
    <% end %>
  <% end %>
</div>
